<?xml version="1.0" encoding="UTF-8"?>
<openerp>
    <data>
        <record id="view_tariff_heading_form" model="ir.ui.view">
            <field name="name">ek.tariff.heading.form</field>
            <field name="model">ek.tariff.heading</field>
            <field name="arch" type="xml">
                <form string="Account">
                    <label for="code" class="oe_edit_only" string="Nombre y código de la partida"/>
                    <h1>
                        <field name="code" class="oe_inline" placeholder="Código Partida" style="width: 229px !important"/> -
                        <field name="name" class="oe_inline" placeholder="Descripción Arancelaria"/>
                    </h1>
                    <group>
                        <group>
                            <field name="parent_id"/>
                            <field name="type"/>
                            <field name="active"/>
                        </group>
                        <group>
                            <field name="tariff" attrs="{'invisible': [('type','=','view')]}" required="1"/>
                            <field name="tariff_percent" attrs="{'invisible': [('type','=','view')]}" required="1"/>
                            <field name="tariff_amount" attrs="{'invisible': [('type','=','view')]}" required="1"/>
                            <field name="unit_control" attrs="{'invisible': [('type','=','view')]}" required="1"/>
                        </group>
                    </group>
                     <notebook colspan="6">
                        <page string="Reglas" attrs="{'invisible': [('type','=','view')]}">
                            <group col="4">
                                <field name="tariff_rule_ids" nolabel="1">
                                    <tree>
                                        <field name="sequence"/>
                                        <field name="code"/>
                                        <field name="name"/>
                                        <field name="category_id"/>
                                        <field name="condition_select"/>
                                        <field name="amount_select"/>
                                    </tree>
                                </field>
                            </group>
                        </page>
                        <page string="Notas">
                            <group col="4">
                                <label for="note"/>
                                <field name="note"/>
                            </group>
                        </page>
                     </notebook>

                </form>
            </field>
        </record>

        <record id="view_tariff_heading_list" model="ir.ui.view">
            <field name="name">ek.tariff.heading.list</field>
            <field name="model">ek.tariff.heading</field>
            <field name="arch" type="xml">
                <tree>
                    <field name="code"/>
                    <field name="name"/>
                    <field name="parent_id" invisible="1"/>
                    <field name="type"/>
                </tree>
            </field>
        </record>

        <record id="view_tariff_heading_search" model="ir.ui.view">
            <field name="name">ek.tariff.heading.search</field>
            <field name="model">ek.tariff.heading</field>
            <field name="arch" type="xml">
                <search string="Partidas">
                    <field name="name" filter_domain="['|', ('name','ilike',self), ('code','ilike',self)]" string="Partida"/>
                    <field name="type"/>
                    <filter name="my_view" string="Vistas" domain="[('type','=','view')]"/>
                    <filter name="my_regulars" string="Regulares" domain="[('type','=','regular')]"/>
                    <group expand="0" string="Agrupar por...">
                        <filter name="my_level" string="Nivel Superiro" context="{'group_by':'parent_id'}"/>
                        <filter name="my_type" string="Tipo" context="{'group_by':'type'}"/>
                    </group>
                </search>
            </field>
        </record>

        <record id="action_tariff_heading_form" model="ir.actions.act_window">
            <field name="name">Partidas Arancelarias</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">ek.tariff.heading</field>
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="view_tariff_heading_search"/>
            <field name="view_id" ref="view_tariff_heading_list"/>
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Haga clic para agregar una partida.
              </p><p>
                PARTIDA ARANCELARIA. Cada uno de los códigos que define en el arancel de aduanas una mercancía determinada o bajo el que se agrupa una categoría de mercancías afines entre sí. Consta de cuatro dígitos: los dos primeros hacen referencia al capítulo y los otros dos identifican el lugar que ocupa dentro del capítulo.
              </p>
            </field>
        </record>
        
        <!--<menuitem id="account_account_menu" name="Partidas Arancelarias" parent="menu_import_root" sequence="15"/>-->
        <menuitem action="action_tariff_heading_form" id="menu_tariff_heading_form" parent="menu_liquidation_in_config" groups="purchase.group_purchase_manager"/>
        
        <record id="view_tariff_heading_tree" model="ir.ui.view">
            <field name="name">ek.tariff.heading.tree</field>
            <field name="model">ek.tariff.heading</field>
            <field name="arch" type="xml">
                <tree>
                    <field name="code"/>
                    <field name="name"/>
                    <field name="parent_id" invisible="1"/>
                    <field name="type"/>
                </tree>
            </field>
        </record>


        <record id="action_tariff_heading_tree" model="ir.actions.act_window">
            <field name="name">Catálogo de Partidas</field>
            <field name="res_model">ek.tariff.heading</field>
            <field name="view_mode">form,tree</field>
            <field name="view_id" ref="view_tariff_heading_tree"/>
            <field name="domain">[('parent_id','=',False)]</field>
        </record>

        <menuitem action="action_tariff_heading_tree" id="menu_tree_tariff" parent="menu_liquidation_in_config" groups="purchase.group_purchase_manager"/>
        
        <!-- Tariff Category-->
        <record id="ek_tariff_rule_category_form" model="ir.ui.view">
            <field name="name">ek.tariff.rule.category.form</field>
            <field name="model">ek.tariff.rule.category</field>
            <field name="arch" type="xml">
                <form string="Categorias">
                    <group col="4">
                        <field name="name"/>
                        <field name="code"/>
                        <field name="parent_id"/>

                    </group>
                    <group col="4" colspan="4">
                        <separator string="Notas"/>
                        <field name="note"/>
                    </group>
                </form>
            </field>
        </record>

        <record id="ek_tariff_rule_category_tree" model="ir.ui.view">
            <field name="name">ek.tariff.rule.category.tree</field>
            <field name="model">ek.tariff.rule.category</field>
            <field name="arch" type="xml">
                <tree string="Categorias">
                    <field name="name"/>
                    <field name="code"/>
                    <field name="parent_id" invisible="1"/>
                </tree>
            </field>
        </record>
        <record id="ek_tariff_rule_category_tree_view" model="ir.ui.view">
            <field name="name">ek.tariff.rule.category.tree.view</field>
            <field name="model">ek.tariff.rule.category</field>
            <field name="field_parent">children_ids</field>
            <field name="arch" type="xml">
                <tree string="Categorias">
                    <field name="name"/>
                    <field name="code"/>
                    <field name="parent_id" invisible="1"/>
                </tree>
            </field>
        </record>

        <record id="view_ek_tariff_rule_category_filter" model="ir.ui.view">
            <field name="name">ek.tariff.rule.category.select</field>
            <field name="model">ek.tariff.rule.category</field>
            <field name="arch" type="xml">
                <search string="Categorias">
                    <field name="name" string="Categorías de reglas" filter_domain="['|',('name','ilike',self),('code','ilike',self)]"/>
               </search>
            </field>
        </record>

         <record id="action_ek_tariff_rule_category" model="ir.actions.act_window">
            <field name="name">Categorías de Rubros</field>
            <field name="res_model">ek.tariff.rule.category</field>
            <field name="view_mode">form,tree</field>
            <field name="view_id" ref="ek_tariff_rule_category_tree"/>
            <field name="search_view_id" ref="view_ek_tariff_rule_category_filter"/>
        </record>

        <menuitem
            id="menu_ek_tariff_rule_category"
            action="action_ek_tariff_rule_category"
            parent="menu_liquidation_in_config"
            sequence="101"
        />


        <!-- Tariff Rules -->

        <record id="ek_tariff_rule_list" model="ir.ui.view">
            <field name="name">ek.tariff.rule.list</field>
            <field name="model">ek.tariff.rule</field>
            <field name="arch" type="xml">
                <tree string="Reglas de Trifas Arancelarias">
                    <field name="name"/>
                    <field name="code"/>
                    <field name="category_id"/>
                    <field name="sequence" invisible="1"/>
                </tree>
            </field>
        </record>

        <record id="ek_tariff_rule_tree" model="ir.ui.view">
            <field name="name">ek.tariff.rule.tree</field>
            <field name="model">ek.tariff.rule</field>
            <field eval="20" name="priority"/>
            <field name="arch" type="xml">
                <tree string="Reglas de Trifas Arancelarias">
                    <field name="name"/>
                    <field name="code"/>
                    <field name="category_id" invisible="True"/>
                </tree>
            </field>
        </record>
        <record id="ek_tariff_rule_form" model="ir.ui.view">
            <field name="name">ek.tariff.rule.form</field>
            <field name="model">ek.tariff.rule</field>
            <field name="arch" type="xml">
                <form string="Reglas de Trifas Arancelarias">
                    <label for="name" class="oe_edit_only"/>
                    <h1><field name="name"/></h1>
                    <label for="category_id" class="oe_edit_only"/>
                    <h2><field name="category_id"/></h2>

                    <group col="4">
                       <field name="code"/>
                       <field name="sequence" />
                       <field name="active"/>
                       <field name="param"/>
                       <field name="terms_id"/>
                    </group>
                    <notebook colspan="6">
                        <page string="General">
                            <group col="4">
                                <separator colspan="4" string="Condiciones"/>
                                <field name="condition_select"/><newline/>
                                <field name="condition_python" attrs="{'invisible':[('condition_select','&lt;&gt;','python')], 'required': [('condition_select','=','python')]}" colspan="4"/> <newline/>
                                <field name="condition_range" attrs="{'invisible':[('condition_select','&lt;&gt;','range')], 'required':[('condition_select','=','range')]}"/><newline/>
                                <field name="condition_range_min" colspan="2" attrs="{'invisible':[('condition_select','&lt;&gt;','range')], 'required':[('condition_select','=','range')]}"/><newline/>
                                <field name="condition_range_max" colspan="2" attrs="{'invisible':[('condition_select','&lt;&gt;','range')], 'required':[('condition_select','=','range')]}"/><newline/>
                                <separator colspan="4" string="Cálculo"/>
                                <field name="amount_select"/><newline/>
                                <field name="amount_percentage_base" attrs="{'invisible':[('amount_select','&lt;&gt;','percentage')], 'required': [('amount_select','=','percentage')]}"/><newline/>
                                <field name="quantity" attrs="{'invisible':[('amount_select','=','code')], 'required':[('amount_select','!=','code')]}"/><newline/>
                                <field name="amount_fix"  attrs="{'invisible':[('amount_select','&lt;&gt;','fix')], 'required':[('amount_select','=','fix')]}"/><newline/>
                                <field colspan="4" name="amount_python_compute" attrs="{'invisible':[('amount_select','&lt;&gt;','code')], 'required':[('amount_select','=','code')]}"/>
                                <field name="amount_percentage" attrs="{'invisible':[('amount_select','&lt;&gt;','percentage')], 'required':[('amount_select','=','percentage')]}"/>

                            </group>
                        </page>
                        <page string="Descripción">
                            <field name="note"/>
                        </page>
                    </notebook>
                </form>
            </field>
        </record>

        <record id="view_tariff_rule_filter" model="ir.ui.view">
            <field name="name">ek.tariff.rule.select</field>
            <field name="model">ek.tariff.rule</field>
            <field name="arch" type="xml">
                <search string="Búsqueda Reglas de Trifas Arancelarias">
                    <field name="name" string="Reglas de Trifas Arancelarias" filter_domain="['|',('name','ilike',self),('code','ilike',self)]"/>
                    <field name="category_id"/>
                    <field name="condition_range_min"/>
                    <group col="8" colspan="4" expand="0" string="Agrupar por">
                        <filter string="Categoría" icon="terp-folder-yellow" name="head" context="{'group_by':'category_id'}"/>
                    </group>
                </search>
            </field>
        </record>


        <record id="action_ek_tariff_rule_form" model="ir.actions.act_window">
            <field name="name">Reglas de Trifas Arancelarias</field>
            <field name="res_model">ek.tariff.rule</field>
            <field name="view_mode">form,tree</field>
            <field name="view_id" ref="ek_tariff_rule_list"/>
            <field name="search_view_id" ref="view_tariff_rule_filter"/>
        </record>

        <menuitem id="menu_action_ek_tariff_rule_form" action="action_ek_tariff_rule_form" parent="menu_liquidation_in_config" sequence="12" groups="purchase.group_purchase_manager"/>

    </data>
</openerp>

